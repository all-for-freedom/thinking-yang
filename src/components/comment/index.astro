---
import type { CollectionEntry } from "astro:content";
import { commentConfig } from "@/config";
import Twikoo from "./Twikoo.astro";

interface Props {
	post: CollectionEntry<"posts">;
}

const { id, data, slug } = Astro.props.post;

// 使用 BASE_URL 确保路径包含 base 前缀（在生产环境中是 '/thinking-yang'）
const baseUrl = import.meta.env.BASE_URL;
const path = `${baseUrl}posts/${slug}`.replace(/\/+/g, '/'); // 确保路径格式正确，移除多余的斜杠
const url = `${Astro.site?.href}${path}`;

let commentService = "";
if (commentConfig?.enable && commentConfig?.twikoo) {
	commentService = "twikoo";
}
---
{commentConfig?.enable && (
  <div class="card-base p-6 mb-4">
    {commentService === 'twikoo' && <Twikoo path={path} />}
    {commentService === '' && null}
  </div>
)}
